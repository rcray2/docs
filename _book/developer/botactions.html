
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Bot Actions Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../scientist/" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Guides to Q
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../analyst/">
            
                <a href="../analyst/">
            
                    
                    Analyst
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../analyst/user-login-and-profile.html">
            
                <a href="../analyst/user-login-and-profile.html">
            
                    
                    User Login and Profile
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    Developer
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1" data-path="botactions.html">
            
                <a href="botactions.html">
            
                    
                    Bot Actions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../scientist/">
            
                <a href="../scientist/">
            
                    
                    Scientist
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../scientist/bots.html">
            
                <a href="../scientist/bots.html">
            
                    
                    Bots
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../scientist/textextractor.html">
            
                <a href="../scientist/textextractor.html">
            
                    
                    Text Extractor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../scientist/cognitive-models.html">
            
                <a href="../scientist/cognitive-models.html">
            
                    
                    Cognitive Models
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../administrator/">
            
                <a href="../administrator/">
            
                    
                    Administrator
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../administrator/deployment/">
            
                <a href="../administrator/deployment/">
            
                    
                    Deployment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="../administrator/deployment/azure.html">
            
                <a href="../administrator/deployment/azure.html">
            
                    
                    Azure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="../administrator/deployment/self-hosted.html">
            
                <a href="../administrator/deployment/self-hosted.html">
            
                    
                    Self Hosted
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../administrator/orchestration.html">
            
                <a href="../administrator/orchestration.html">
            
                    
                    Orchestration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../administrator/user-and-policy-management.html">
            
                <a href="../administrator/user-and-policy-management.html">
            
                    
                    User and Policy Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../administrator/logging.html">
            
                <a href="../administrator/logging.html">
            
                    
                    Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../administrator/monitoring.html">
            
                <a href="../administrator/monitoring.html">
            
                    
                    Monitoring
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../releasenotes/">
            
                <a href="../releasenotes/">
            
                    
                    Release Notes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../releasenotes/v3-1-2.html">
            
                <a href="../releasenotes/v3-1-2.html">
            
                    
                    v3.1.2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../releasenotes/v3-1-1.html">
            
                <a href="../releasenotes/v3-1-1.html">
            
                    
                    v3.1.1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../releasenotes/v3-1-0.html">
            
                <a href="../releasenotes/v3-1-0.html">
            
                    
                    v3.1.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../releasenotes/v3-0-5.html">
            
                <a href="../releasenotes/v3-0-5.html">
            
                    
                    v3.0.5
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../tutorials/">
            
                <a href="../tutorials/">
            
                    
                    Tutorials
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../tutorials/ui.html">
            
                <a href="../tutorials/ui.html">
            
                    
                    UI 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../tutorials/cli.html">
            
                <a href="../tutorials/cli.html">
            
                    
                    CLI 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../prisma.md">
            
                <span>
            
                    
                    Prisma
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../faq.html">
            
                <a href="../faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../glossary.html">
            
                <a href="../glossary.html">
            
                    
                    Glossary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../contact.html">
            
                <a href="../contact.html">
            
                    
                    Contact
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Bot Actions</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="bot-actions">Bot Actions</h1>
<p>Maana Knowledge Services form <a href="../glossary.html#a" class="glossary-term" title="">a</a> network of GraphQL endpoints, exposing their types, queries, and mutations for direct access, as well as publishing and subscribing to network events.  The Maana platform manages these services, providing authentication, reliable messaging, (automatic) graph persistence (with search and querying), scaling, monitoring, and <a href="../glossary.html#a" class="glossary-term" title="">a</a> rich UX.</p>
<p>Knowledge Services can become Knowledge &quot;Bots&quot; by offering and using &quot;bot actions,&quot; which allows the service to interact more directly to users.  Users can configure, start, stop, and schedule bot actions.  Services can report on status and progress for potentially long-running, asynchronous operations, as well as report any errors or messages.</p>
<p>There are two primary scenarios: event handling and direct query or mutation.</p>
<h2 id="event-handling">Event Handling</h2>
<p>When <a href="../glossary.html#a" class="glossary-term" title="">a</a> Knowledge Service subscribes to and handles an event, such as &quot;fileAdded,&quot; it can (optionally) create an instance of <a href="../glossary.html#a" class="glossary-term" title="">a</a> BotAction Kind by mutating the CKG.  As the service performs its operation, it can periodically update the progress (if it is deterministic) and update the status and report errors.</p>
<h2 id="queries-and-mutations">Queries and Mutations</h2>
<p><a href="../glossary.html#a" class="glossary-term" title="">A</a> user can invokes <a href="../glossary.html#a" class="glossary-term" title="">a</a> query or mutation either explicitly (<a href="../glossary.html#e" class="glossary-term" title="">e</a>.<a href="../glossary.html#g" class="glossary-term" title="">g</a>., train <a href="../glossary.html#a" class="glossary-term" title="">a</a> classifier on labeled data) or implicitly (<a href="../glossary.html#i" class="glossary-term" title="">i</a>.<a href="../glossary.html#e" class="glossary-term" title="">e</a>., as part of query graph).  In such cases, the service exposes such queries and mutations as returning <a href="../glossary.html#a" class="glossary-term" title="">a</a> BotAction, which indicates to the UI that these are available.</p>
<h2 id="user-experience">User Experience</h2>
<p>The UI (Explorer, KGE, Context) will query for active BotActions and indicate progress and status on relevant Kinds and instances.  Using stock functionality, service queries and mutations can be connected to inputs and outputs, and static parameters can be set.  Additionally, users can stop/cancel long-running operations, and possibly resume, if the service supports it.</p>
<h2 id="schema">Schema</h2>
<pre><code>enum BotActionStatus {
  PENDING # initial
  IN_PROGRESS
  STOPPING # request to stop processing
  STOPPED # paused, if operation can be resumed, otherwise ERROR (cancelled)
  ERROR # stopped with service-defined or system-defined error(s)
  COMPLETE # stopped without error
}

type BotAction {
  # io.maana.kind
  id: ID! # generated
  # bookkeeping
  created: DateTime! # generated
  lastUpdated: DateTime! # generated
  # disposition
  info: String # human-friendly description
  status: BotActionStatus! # generated (updatable)
  progress: Float # if available, otherwise undetermined
  errors: [JSON!]
  # operation
  service: Service! # who is performing the action
  eventName: String # if in response to an event
  mutation: ServiceMutation # either a mutation
  query: ServiceQuery # or a query
  input: InstanceRef # query/mutation arguments
  output: InstanceRef # query/mutation results
  # lineage
  parent: BotAction
}
</code></pre><h2 id="sample-query">Sample Query</h2>
<pre><code>query botAction($id: ID!) {
  botAction(id: $id) {
    name
    service {
      name
    }
    status
    error
  }
</code></pre><h2 id="helpers">Helpers</h2>
<h3 id="node">Node</h3>
<p>For <a href="https://github.com/maana-io/Q-ksvc-templates/tree/master/node" target="_blank">node-based Bots</a>, the following helpers have been added to <a href="https://bitbucket.corp.maana.io/projects/H4/repos/h4/browse/ksvcs/packages/maana-shared/src/botAction.js" target="_blank">maana-shared</a>:</p>
<pre><code>/**
 * Create a new bot action describing our potentially long-running async operation
 *
 * @param {ApolloClient} client to the GraphQL service
 * @param {CreateBotActionInput} input values for the new BotAction instance
 * @return {ID} identity of the new BotAction instance
 */
export const createBotAction = async (client, input) =&gt; { ... }

/**
 * Update the bot action (e.g., progress, status, errors)
 *
 * @param {ApolloClient} client to the GraphQL service
 * @param {UpdateBotActionInput} input values for the existing BotAction instance
 * @return {ID} identity confirmation of the BotAction instance, if updated
 */
export const updateBotAction = async (client, input) =&gt; { ... }
</code></pre><h4 id="example">Example</h4>
<pre><code>
import {
  BotActionStatus,
  createBotAction,
  updateBotAction
} from &apos;io.maana.shared&apos;


export const doAsyncTask = async (client, input) =&gt; {
  // Create a BotAction using helper
  const botActionId = await createBotAction(client, {
    serviceId: process.env.SERVICE_ID,
    info: &apos;task being done asynchronously&apos;
  })


  // Async operation
  const _doAsync = async () =&gt; {


    // ...


    // something went wrong
    const confirmId = await updateBotAction(client, {
      id: botActionId,
      status: BotActionStatus.ERROR,
      info: &apos;task failed&apos;
    })


    // task completed successfully
    const confirmId = await updateBotAction(client, {
      id: botActionId,
      status: BotActionStatus.COMPLETE,
      info: &apos;task completed&apos;
    })
  }
  _doAsync()


  // Return the bot action id to our caller so they can track the task
  return botActionId
}
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Developer">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../scientist/" class="navigation navigation-next " aria-label="Next page: Scientist">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Bot Actions","level":"1.3.1","depth":2,"next":{"title":"Scientist","level":"1.4","depth":1,"path":"scientist/README.md","ref":"scientist/README.md","articles":[{"title":"Bots","level":"1.4.1","depth":2,"path":"scientist/bots.md","ref":"scientist/bots.md","articles":[{"title":"Text Extractor","level":"1.4.1.1","depth":3,"path":"scientist/textextractor.md","ref":"scientist/textextractor.md","articles":[]}]},{"title":"Cognitive Models","level":"1.4.2","depth":2,"path":"scientist/cognitive-models.md","ref":"scientist/cognitive-models.md","articles":[]}]},"previous":{"title":"Developer","level":"1.3","depth":1,"path":"developer/README.md","ref":"developer/README.md","articles":[{"title":"Bot Actions","level":"1.3.1","depth":2,"path":"developer/botactions.md","ref":"developer/botactions.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"developer/botactions.md","mtime":"2018-08-08T17:07:58.829Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-08-09T17:51:06.691Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

